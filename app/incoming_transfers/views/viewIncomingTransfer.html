<div id="content">
    <div class="well well-white">
        <h2 class="txt-color-blueDark semi-bold prod-review-title no-padding">{{visual.titles + incomingTransfer.number}}</h2>
        <form-nav-buttons options="visual.navButtsOptions" class="btn-group margin-top-10"></form-nav-buttons>
        <hr>
        <div class="row margin-top-10">
            <p class="col-xs-12 col-md-3 font-bold">
                Входящий номер:
            </p>
            <p class="col-md-9">{{incomingTransfer.number}}</p>
        </div>
        <div class="row">
            <p class="col-xs-12 col-md-3 font-bold">
                Партнёр:
            </p>
            <p class="col-md-9">
                <a ng-href="/#/partners/{{incomingTransfer.partner.id}}">{{incomingTransfer.partner.name}}</a>
            </p>
        </div>
        <div class="row">
            <p class="col-xs-12 col-md-3 font-bold">
                Входящая дата:
            </p>
            <p class="col-md-9">{{incomingTransfer.date | date:'dd MMMM yy'}}</p>
        </div>
        <div class="row">
            <p class="col-xs-12 col-md-3 font-bold">
                Назчание:
            </p>
            <p class="col-md-9">{{incomingTransfer.description}}</p>
        </div>
    </div>
    
    <div class="well well-white">
        <table class="table table-bordered margin-top-10" ng-if="visual.roles.can_edit">
            <thead>
            <tr>
                <th>Заказ клиента/Исходящий платеж</th>
                <th>Сумма</th>
                <th></th>
            </tr>
            </thead>
            <tbody>
                <tr>
                    <td>
                        <ui-select id="vit_order_select"  ui-select-infinity="orderSelectConf" ng-model="data.orderForAppend" theme="select2" class="td-ui-select">
                            <ui-select-match placeholder="Выберите заказ">{{$select.selected.number || $select.selected.incoming_code}}</ui-select-match>
                            <ui-select-choices repeat="order in data.ordersList">
                                <div ng-bind-html="order | f_incomingT | highlight: $select.search"></div>
                            </ui-select-choices>
                        </ui-select>
                    </td>
                    <td ng-keypress="data.orderForAppend.id && appendOrder($event)">
                        <input id="append_order_amount" class="form-control table-input" ng-model="data.orderForAppend.amount" model-filter="{min:0, number:true, max:transfer.remaining_amount}" filter-name="te_number" type="text">
                    </td>
                    <td class="center-item-text">
                        <div ng-click="appendOrder()" class="btn btn-success" ng-disabled="!data.orderForAppend.id">
                            <i class="fa fa-plus"></i>
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
        <table class="table">
            <thead>
                <tr>
                    <th/>
                    <th>Заказ клиента</th>
                    <th>Исходящий платёж</th>
                    <th>Сумма</th>
                    <th/>
                </tr>
            </thead>
            <tbody>
                <tr ng-repeat="item in incomingTransfer.money_to_orders">
                    <td>{{ $index + 1 }}</td>
                    <td><span ng-if="item.hasOwnProperty('customer_order')">{{ item.customer_order.number }}</span></td>
                    <td><span ng-if="item.hasOwnProperty('outgoing_transfer')">{{ item.outgoing_transfer.number }}</span></td>
                    <td>{{ item.amount | currency }}</td>
                    <td>
                        <form-nav-buttons data-role="visual.roles" data-role="row" class="btn-group" data-options="visual.navTableButts" subdata="{data:item, index:$index}" data-template="table" content-class="btn btn-xs"></form-nav-buttons>
                    </td>
                </tr>
                <tr>
                    <td colspan="3" class="text-right">Итого:</td>
                    <td>{{ incomingTransfer.amount | currency }}</td>
                    <td/>
                </tr>
            </tbody>
        </table>
    </div>
    <file-worker data-trigger="visual.showFileModal" data-config="fileModalOptions"></file-worker>
</div>